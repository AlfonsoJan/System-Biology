---
output:
  pdf_document: 
    pandoc_args: --highlight=breezedark
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
library(deSolve)
library(randomcoloR)
```

# Comparing Two Different Models.

## The comparison of two different models of the Central Regulatory Circuit of Drosophila.

\vspace*{\fill}
\begin{flushright}
John Busker, Sven Schoonen\\
352905 ...\\
BFV2\\
8-6-2022\\
Themaopdracht 8
\end{flushright}

\newpage

# Abstract

We established and observed two different models of Central Regulatory Circuit of Drosophila from different articles and compared them. The models describe the Central Regulatory Circuit which acts in the early stage of the *Drosophila melanogaster* mechanoreceptors morphogenesis. The main component of the Central Regulatory Circuit is the complex of *Achaete-Scute* genes.

\newpage

# Result

```{r}
plotModel <- function(df){
plot(df$time, df$ASC, type='l',ylim=c(0, 4), col=cols[1], lwd=2, xlab="time", ylab="concentration")
lines(df$time, df$Hairy, col=cols[2], lwd=2)
lines(df$time, df$Senseless, col=cols[3], lwd=2)
lines(df$time, df$Scratch, col=cols[4], lwd=2)
lines(df$time, df$Charlatan, col=cols[5], lwd=2)
lines(df$time, df$Phyllopod, col=cols[6], lwd=2)
legend("topright",ncol=3, c("AS-C","Hairy","Senseless", "Scratch", "Charlatan", "Phyllopod"), fill=c(cols[1],cols[2],cols[3], cols[4], cols[5], cols[6]))
}
```

```{r}
'%=%' <- function(x, y) {
  x <- as.character(substitute(x)[-1])
  if (length(y) < length(x))
    y <- rep(y, ceiling(length(x) / length(y)))
  if (length(y) > length(x))
    y <- y[1:length(x)]
  mapply(assign, x, y, MoreArgs = list(envir = parent.frame()))
  invisible()
}

h <- function(i) i > 0

sigma1 <- function (v) {
  h(v) * d1 * v ^ n1 / (1 + v ^ n1)
}
sigma3 <- function (v) {
  h(v) * d3 * v ^ n3 / (1 + v ^ n3)
}
sigma5 <- function (v) {
  h(v) * d5 * v ^ n5 / (1 + v ^ n5)
}
s3 <- function (v) {
  h(v) * a3 * exp((v - b3) / c3) / (1 + exp((v - b3) / c3))
}
s4 <- function (v) {
  h(v) * a4 * exp((v - b4) / c4) / (1 + exp((v - b4) / c4))
}
s5 <- function (v) {
  h(v) * a5 * exp((v - b5) / c5) / (1 + exp((v - b5) / c5))
}
s6 <- function (v) {
  h(v) * a6 * exp((v - b6) / c6) / (1 + exp((v - b6) / c6))
}

dt_x = 0
dt_y = 0
dt_z = 0
dt_u = 0
dt_w = 0
dt_p = 0
Gro = 1
EMC = 1
D = 2.05
UB = 1.17
SINA = 5.6
C = 1
n1 = 2
n3 = 2
n5 = 2
m1 = 1
m2 = 1
m3 = 1
m4 = 1
m5 = 1
m6 = 1
m7 = 1
L = 1
kx = 1
ky =1
kz = 1
ku = 1
kw = 1
kp = 1
a3 =  3.61
b3 = 4.96
c3 = 1.35
a4 = 4.43
b4 = 6.09
c4 = 1.66
a5 = 8.09
b5 = 11.13
c5 = 3.03
a6 = 2.67
b6 = 3.67
c6 = 1.00
d1 = 7.46
d3 = 2.77
d5 = 1.24
y0 = 3
x0 = 3 / 20
z0 = 3 / 20
u0 = 0
w0 = 0
p0 = 0
```


```{r}
x_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- (sigma1(D * x) + sigma3(z) + sigma5(w)) / ((1 + Gro * y) * (1 + EMC * x)) - kx * (1 + p_curr * UB * SINA) * x
  }
}
y_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- (C / (d1 + u_curr)) - ky * y_curr
  }
}
z_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- s3(D * x) - kz * z_curr
  }
}
u_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- s4(D * x) - ku * u_curr
  }
}
w_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- s5(D * x) - kw * w_curr
  }
}
p_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- (s6(D * x) * h(t - 12) * (t - 12) ^ 2) / (1 + (t - 12) ^ 2) - kp * p_curr
  }
}
    
model <- function(t, p, parms, ...) {
       list(c(x_model(t, dt_x, x0, p), y_model(t, dt_y, y0, p), z_model(t, dt_z, z0, p), u_model(t, dt_u, u0, p), w_model(t, dt_w, w0, p), p_model(t, dt_p, p0, p)))
}
```


```{r}
t <- seq(0, 16, by = 0.1)
start <- c(x0 * kx, y0 * ky, z0 * kz, u0 * ku, w0 * kw, p0 * kp)
traj <- data.frame(dede(start, t, func = model, parms = parameters))

cols <- distinctColorPalette(6)

plot.new()

rect(par("usr")[1], par("usr")[3],
     par("usr")[2], par("usr")[4],
     col = "#fdfbf3")
par(new = TRUE)
names(traj) <- c("time", "ASC", "Hairy", "Senseless", "Scratch", "Charlatan", "Phyllopod")

plotModel(traj)
```

```{r}
x_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- kx * (sigma1(D * x) + sigma3(z) + sigma5(w)) / ((1 + Gro * y) * (1 + EMC * x)) - m1 * x * (1 + p_curr * UB * SINA)
  }
}
y_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- ky * C / (1 + u ^ m7) - m2 * y_curr
  }
}
z_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- kz * s3(D * x) - m3 * z_curr
  }
}
u_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- ku * s4(D * x) - m4 * u_curr
  }
}
w_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- kw * s5(D * x) - m5 * w_curr
  }
}
p_model <- function(t, dt, startValue, point, args, ...) {
  if (t < 0) { startValue }
  else {
    c(x, y, z, u, w, p) %=% point
    c(x_curr, y_curr, z_curr, u_curr, w_curr, p_curr) %=% point
    lagPoint <- (s6(D * x) * h(t - 12) * (t - 12) ^ 2) / (1 + (t - 12) ^ 2) - kp * p_curr
  }
}
```

```{r}
traj <- data.frame(dede(start, t, func = model, parms = parameters))


plot.new()

rect(par("usr")[1], par("usr")[3],
     par("usr")[2], par("usr")[4],
     col = "#fdfbf3")
par(new = TRUE)
names(traj) <- c("time", "ASC", "Hairy", "Senseless", "Scratch", "Charlatan", "Phyllopod")

plotModel(traj)
```
